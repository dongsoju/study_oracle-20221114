--연습문제 5-1


--1.이름에 소문자v가포함된 모든 사원의 사번 이름 부서명을 조회하는 쿼리를 작성하시오
--
--대, 소문자를 구분 :'v'  vs  'VS'는 다름.
--EQUI-JOIN : 동등 연산자를 이용한 오라클조인(=내부조인)


SELECT e.employee_id, e.first_name,
       d.department_name
FROM   employees e, departments d
WHERE  e. department_id = d.department_id
AND    e.first_name LIKE '%v%'
ORDER BY 1;

--2. 커미션을 받는 사원의 사번,이름,급여,커미션 금액,부서명을 조회하는 쿼릴를 작성하시오
--단,커민션 금액은 울급여에 대한 커미션 금액을 나타낸다 ==> salary *commission_pct == commission
SELECT e.employee_id, e.first_name, e.salart,(salary * NVL(commission_pct,0))bonus,
       d.department_name
FROM   e.employees  e, d.departments_id
WHERE  e.department_id =d.department_id
AND    commission_pct IS NULL
ORDER  BY 1;
--3.각 부서의 부서코드,부서명,위치코드,도시명,국가코드,국가명을 조회하시오
SELECT  d.department_id, d.department_name, l.location_id,
        l.city, c.country_name,c.country_id 
FROM    departments d,locations l,countries c
WHERE   d.location_id = l.location_id
AND     l.country_id = c.country_id
ORDER BY 1;

--4
SELECT    e.employee_id, e.first_name,  e.job_id,
          m.employee_id manager_id,
          m.first_name  manager_name,
          m.job_id manager_job_id
FROM      employees e  ,   employees m
WHERE     e.manager_id = m.employee_id
AND       e.manager_id IS NOT NULL
ORDER  BY 1;


--




















